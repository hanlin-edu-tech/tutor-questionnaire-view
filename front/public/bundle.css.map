{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../src/App.svelte"
  ],
  "sourcesContent": [
    "<script>\n\timport {onMount} from 'svelte'\n\timport Question from './Question.svelte'\n\tlet template\n\tlet questionnaire = {\n\t\tstarted: null,\n\t\tfinished: null,\n\t\tquestions: [],\n\t\ttemplate: '',\n\t\tfinishMsg: '',\n\t\tcallBackUrl: ''\n\t}\n\tlet questions = new Array()\n\tlet success\n\tlet callBackUrl\n\tconst questionId = window.location.search.substring(4,window.location.search.length)\n\tonMount(async () => {\n\t\tif(window.location.protocol === \"http:\"){\n\t\t\tconst path = window.location.href.split(\":\")[1]\t\t\n\t\t\twindow.location.href = `https:${path}`\n\t\t}\n\t\tconst host = window.location.hostname\n        let contextPath = ''\n\t\tawait fetch(`https://${host}${contextPath}/questionnaire/templates/${questionId}`)\n\t\t.then(res => {\n\t\t\treturn res.json()\n\t\t})\n\t\t.then(data => {\n\t\t\tquestionnaire.started = new Date()\n\t\t\tquestionnaire.template = questionId\n\t\t\tquestionnaire.callBackUrl = data.callBackUrl\n\t\t\tquestionnaire.finishMsg = data.finishMsg\n\t\t\ttemplate = data\n\t\t\tconst count = data.questions.length\n\t\t\tfor(let i=0; i<count; i++){\n\t\t\t\tquestions.push({\n\t\t\t\t\t\"topic\":data.questions[i].topic,\n\t\t\t\t\t\"answer\":\"\",\n\t\t\t\t\t\"required\":data.questions[i].required,\n\t\t\t\t\t\"type\":data.questions[i].type,\n\t\t\t\t\t\"options\":data.questions[i].options\n\t\t\t\t})\n\t\t\t}\n\t\t})\n\t});\n\tfunction submit(){\t\t\n\t\t// console.log('questions: ', questionnaire.questions)\n\t\tif(!validate()){\n\t\t\tsuccess = false\n\t\t\treturn false\n\t\t}\n\t\tquestionnaire.finished = new Date()\n\t\tquestionnaire.questions = questions\t\n\t\tconvertAns()\n\t\tconst host = window.location.hostname\n        let contextPath = ''\n\t\tfetch(`https://${host}${contextPath}/questionnaire/questionnaire/create?templateId=${questionId}`,{\n\t\t\tmethod: \"post\",\n\t\t\tbody: JSON.stringify(questionnaire),\n\t\t\theaders: {\n\t\t\t\t'content-type': 'application/json'\n\t\t\t},\n\t\t\tcredentials: 'include'\n\t\t})\n\t\t.then(function(body){\n\t\t\tif(body.ok){\n\t\t\t\tsuccess = true\n\t\t\t\tif(questionnaire.callBackUrl.trim() !== \"\"){\n\t\t\t\t\tsetTimeout(()=>{window.location.href = questionnaire.callBackUrl}, 700)\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t})\n\t\t\n\t}\n\tfunction validate(){\n\t\tlet validate = true\n\t\tquestions.forEach((data, index) => {\n\t\t\tdocument.getElementById(\"q\"+index).classList.remove(\"invalid\")\n\t\t\tdocument.getElementById(\"must\"+index).classList.add(\"hide\")\n\t\t\tif(data.required === true){\n\t\t\t\tif(data.type === '問答題' && data.answer.trim() === \"\"){\t\t\t\t\t\n\t\t\t\t\twarning(index)\n\t\t\t\t\tvalidate = false\n\t\t\t\t}else if(data.type === '多選題' && data.answer.length === 0 ){\n\t\t\t\t\twarning(index)\n\t\t\t\t\tvalidate = false\n\t\t\t\t}else{\n\t\t\t\t\tif(data.answer === \"\"){\n\t\t\t\t\t\twarning(index)\n\t\t\t\t\t\tvalidate = false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t\treturn validate\n\t}\n\n\tfunction warning(index){\n\t\tdocument.getElementById(\"q\"+index).classList.add(\"invalid\")\n\t\tdocument.getElementById(\"must\"+index).classList.remove(\"hide\")\n\t}\n\n\tfunction convertAns(){\n\t\tquestions.forEach(data => {\n\t\t\tif(!Array.isArray(data.answer)){\n\t\t\t\tdata.answer = [data.answer]\n\t\t\t}\n\t\t})\n\t}\n</script>\n<style>\n\t.container {\n\t\twidth: 980px;\n\t\tmargin: 0 auto;\n\t\tbackground-color: rgba(255, 255, 255, 0.685);\n\t}\n\t#main {\n\t\tdisplay: flex;\n\t}\n</style>\n<svelte:head>\n\t{#if template}\n\t\t<title>{template.name}</title>\n\t{:else}\n\t\t<title>問卷</title>\n\t{/if}\n</svelte:head>\n\n<div id=\"main\">\n\t{#if template}\n\t\t<div class=\"container\">\n\t\t\t<div class=\"alert\">\n\t\t\t\t<div class=\"form-title\">{template.name}</div>\n\t\t\t\t<div class=\"form-content\">{template.description}</div>\n\t\t\t</div>\n\t\t\t<form action=\"\" id=\"form\">\n\t\t\t\t<div class=\"form-body\">\n\t\t\t\t{#each template.questions as q, i}\n\t\t\t\t\t<Question question=\"{q}\" index=\"{i}\" questions=\"{questions}\"/>\n\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"row-btn\" style=\"margin-bottom:10px;\">\n\t\t\t\t\t<div class=\"btn-send\" on:click=\"{submit}\">送出</div>\n\t\t\t\t</div>\t\t\n\t\t\t</form>\n\t\t</div>\n\t\t<!-- 成功畫面-->\n\t\t{#if success === true}\n\t\t\t<div class=\"modal-success\">\n\t\t\t\t<div class=\"modal-body\">\n\t\t\t\t\t<div class=\"success-banner\"></div>\n\t\t\t\t\t<div class=\"success-text\">送出成功</div>\n\t\t\t\t\t{#if template.finishMsg}\n\t\t\t\t\t\t<div class=\"success-content\">{template.finishMsg}</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{/if}\n\t{:else}\n\t\tloading\t\t\n\t{/if}\n</div>"
  ],
  "names": [],
  "mappings": "AAiHC,UAAU,cAAC,CAAC,AACX,KAAK,CAAE,KAAK,CACZ,MAAM,CAAE,CAAC,CAAC,IAAI,CACd,gBAAgB,CAAE,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,AAC7C,CAAC,AACD,KAAK,cAAC,CAAC,AACN,OAAO,CAAE,IAAI,AACd,CAAC"
}